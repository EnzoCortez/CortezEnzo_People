<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:model="clr-namespace:People.Models"
             xmlns:vm="clr-namespace:People.ViewModels"
             x:Class="People.MainPage"
             BackgroundColor="{DynamicResource Light}">

    <!-- Establecer el contexto de Binding -->
    <ContentPage.BindingContext>
        <vm:MainPageViewModel />
    </ContentPage.BindingContext>

    <Grid Padding="5" RowSpacing="5" ColumnSpacing="5"
          RowDefinitions="Auto,Auto,Auto,*">

        <!-- Entrada para el nombre -->
        <Entry Text="{Binding NewPersonName}" 
               Placeholder="Ingresa un nombre" 
               Grid.Row="0" />

        <!-- Botón para añadir una persona -->
        <Button Text="Agregar persona" 
                Command="{Binding AddPersonCommand}" 
                Grid.Row="1" />

        <!-- Mensaje de estado -->
        <Label Text="{Binding StatusMessage}" 
               TextColor="{StaticResource Primary}" 
               Grid.Row="2" />



        <CollectionView x:Name="peopleList" ItemsSource="{Binding People}" Grid.Row="4">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="model:Person">
                    <Grid ColumnDefinitions="*,Auto">
                        <!-- Texto del registro -->
                        <Label Text="{Binding Name}" 
                       VerticalOptions="Center" 
                       TextColor="{StaticResource Primary}" />

                        <!-- Botón de borrado -->
                        <Button Text="Borrar" 
                        Command="{Binding Path=BindingContext.DeletePersonCommand, Source={x:Reference peopleList}}" 
                        CommandParameter="{Binding .}" 
                        BackgroundColor="Red" 
                        TextColor="White" 
                        Margin="5,0,0,0"
                        Grid.Column="1" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>


    </Grid>
</ContentPage>
